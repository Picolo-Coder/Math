<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adicionar Dados</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
</head>
<body id="Add">
    <nav class="navbar bg-body-tertiary">
        <div class="container-fluid">
            <a class="navbar-brand"><h1>Winkpπdia</h1></a>
            <div class="sub">
                <h1>___</h1>
                <h1>pi</h1>
            </div>
            <i class="bi bi-book-half" id="a"></i>
        </div>
        <button class="tchau" onclick="history.back()">
            <i class="bi bi-box-arrow-left"></i>
        </button>        
    </nav>
    
    <main>
        <div class="container text-center">
            <h1>Adicionar Dados nas Tabelas</h1>
        
            <!-- Select para escolher a tabela -->
            <div class="mb-4">
                <label for="tabela" class="form-label">Escolha uma Tabela:</label>
                <select id="tabela" name="tabela" class="form-select" onchange="exibirFormulario()">
                    <option value="">Selecione uma tabela</option>
                    <option value="Algebra">Álgebra</option>
                    <option value="Geometria">Geometria</option>
                    <option value="Combinatoria">Combinatória</option>
                    <option value="Aritmetica">Aritmética</option>
                    <option value="Trigonometria">Trigonometria</option>
                </select>
            </div>
    
            <!-- Formulário para Álgebra -->
            <div id="form-algebra" class="form-container" style="display:none;">
                <h2>Adicionar Dados - Álgebra</h2>
                <form id="form-algebra-acao">
                    <div class="mb-3">
                        <label for="titulo" class="form-label">Título:</label>
                        <input type="text" id="titulo-algebra" name="titulo" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="definicao" class="form-label">Definição:</label>
                        <textarea id="definicao-algebra" name="definicao" class="form-control" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                </form>
            </div>
    
            <!-- Formulário para Geometria -->
            <div id="form-geometria" class="form-container" style="display:none;">
                <h2>Adicionar Dados - Geometria</h2>
                <form id="form-geometria-acao" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="titulo" class="form-label">Título:</label>
                        <input type="text" id="titulo-geometria" name="titulo" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="definicao" class="form-label">Definição:</label>
                        <textarea id="definicao-geometria" name="definicao" class="form-control" required></textarea>
                    </div>
                    <div class="mb-3">
                        <label for="imagem" class="form-label">Imagem:</label>
                        <input type="file" id="imagem-geometria" name="imagem" class="form-control" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                </form>
            </div>
    
            <!-- Formulário para Combinatória -->
            <div id="form-combinatoria" class="form-container" style="display:none;">
                <h2>Adicionar Dados - Combinatória</h2>
                <form id="form-combinatoria-acao" method="POST">
                    <div class="mb-3">
                        <label for="titulo" class="form-label">Título:</label>
                        <input type="text" id="titulo-combinatoria" name="titulo" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="definicao" class="form-label">Definição:</label>
                        <textarea id="definicao-combinatoria" name="definicao" class="form-control" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                </form>
            </div>
    
            <!-- Formulário para Aritmética -->
            <div id="form-aritmetica" class="form-container" style="display:none;">
                <h2>Adicionar Dados - Aritmética</h2>
                <form id="form-aritmetica-acao" method="POST">
                    <div class="mb-3">
                        <label for="titulo" class="form-label">Título:</label>
                        <input type="text" id="titulo-aritmetica" name="titulo" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="definicao" class="form-label">Definição:</label>
                        <textarea id="definicao-aritmetica" name="definicao" class="form-control" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                </form>
            </div>
    
            <!-- Formulário para Trigonometria -->
            <div id="form-trigonometria" class="form-container" style="display:none;">
                <h2>Adicionar Dados - Trigonometria</h2>
                <form id="form-trigonometria-acao">
                    <div class="mb-3">
                        <label for="titulo" class="form-label">Título:</label>
                        <input type="text" id="titulo-trigonometria" name="titulo" class="form-control" required>
                    </div>
                    <div class="mb-3">
                        <label for="definicao" class="form-label">Definição:</label>
                        <textarea id="definicao-trigonometria" name="definicao" class="form-control" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Adicionar</button>
                </form>
            </div>
        </div>
    </main>

    <script>
        // Função para mostrar e esconder formulários conforme a tabela selecionada
        function exibirFormulario() {
            const tabela = document.getElementById('tabela').value;
            const formularios = ['algebra', 'geometria', 'combinatoria', 'aritmetica', 'trigonometria'];  // Corrigido o nome para 'trigonometria'

            // Esconde todos os formulários
            formularios.forEach(form => {
                document.getElementById(`form-${form}`).style.display = 'none';
            });

            // Mostra o formulário da tabela selecionada
            if (tabela) {
                document.getElementById(`form-${tabela.toLowerCase()}`).style.display = 'block';
            }
        }

        // Enviar dados do formulário de Álgebra via fetch
        document.getElementById('form-algebra-acao').addEventListener('submit', function(event) {
            event.preventDefault();

            // Captura os dados do formulário
            const titulo = document.getElementById('titulo-algebra').value;
            const definicao = document.getElementById('definicao-algebra').value;

            // Monta o corpo da requisição
            const payload = {
                titulo: titulo,
                definicao: definicao
            };

            // Envia os dados para o backend
            fetch('http://127.0.0.1:3000/api/algebra', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload),
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message || 'Dados enviados com sucesso!');
                document.getElementById('form-algebra-acao').reset();
            })
            .catch(error => {
                alert('Erro ao enviar os dados: ' + error.message);
            });
        });

        // Enviar dados do formulário de Geometria via fetch
        document.getElementById('form-geometria-acao').addEventListener('submit', function(event) {
            event.preventDefault();

            // Captura os dados do formulário
            const formData = new FormData();
            formData.append('titulo', document.getElementById('titulo-geometria').value);
            formData.append('definicao', document.getElementById('definicao-geometria').value);
            formData.append('imagem', document.getElementById('imagem-geometria').files[0]);

            // Envia os dados para o backend
            fetch('http://127.0.0.1:3000/api/geometria', {
                method: 'POST',
                body: formData,
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message || 'Dados enviados com sucesso!');
                document.getElementById('form-geometria-acao').reset();
            })
            .catch(error => {
                alert('Erro ao enviar os dados: ' + error.message);
            });
        });

        // Função para enviar os dados do formulário de Combinatória
        document.getElementById('form-combinatoria-acao').addEventListener('submit', function (event) {
            event.preventDefault(); // Impede o envio padrão do formulário

            const titulo = document.getElementById('titulo-combinatoria').value;
            const definicao = document.getElementById('definicao-combinatoria').value;

            // Corpo da requisição
            const data = { titulo, definicao };

            // Enviar dados para a rota POST do backend
            fetch('http://127.0.0.1:3000/api/combinatoria', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
                .then((response) => {
                    if (response.ok) {
                        alert('Dados enviados com sucesso!');
                        document.getElementById('form-combinatoria-acao').reset(); // Limpar o formulário
                    } else {
                        return response.json().then((err) => {
                            throw new Error(err.error || 'Erro ao enviar os dados');
                        });
                    }
                })
                .catch((error) => {
                    alert('Erro: ' + error.message);
                });
        });

        document.getElementById('form-aritmetica').addEventListener('submit', function (event) {
    event.preventDefault(); // Impede o envio padrão do formulário

    const titulo = document.getElementById('titulo-aritmetica').value;
    const definicao = document.getElementById('definicao-aritmetica').value;

    // Corpo da requisição
    const data = { titulo, definicao };

    // Enviar dados para a rota POST do backend
    fetch('http://127.0.0.1:3000/api/aritmetica', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data),
    })
        .then((response) => response.json())
        .then((data) => {
            alert('Dados enviados com sucesso!');
            
            // Limpar os campos do formulário manualmente
            document.getElementById('titulo-aritmetica').value = '';
            document.getElementById('definicao-aritmetica').value = '';
        })
        .catch((error) => {
            alert('Erro: ' + error.message);
        });
});
    

        // Enviar dados do formulário de Trigonometria via fetch
        document.getElementById('form-trigonometria-acao').addEventListener('submit', function(event) {
            event.preventDefault();

            const titulo = document.getElementById('titulo-trigonometria').value;
            const definicao = document.getElementById('definicao-trigonometria').value;

            // Monta o corpo da requisição
            const payload = {
                titulo: titulo,
                definicao: definicao
            };

            // Envia os dados para o backend
            fetch('http://127.0.0.1:3000/api/trigonometria', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(payload),
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message || 'Dados enviados com sucesso!');
                document.getElementById('form-trigonometria-acao').reset();
            })
            .catch(error => {
                alert('Erro ao enviar os dados: ' + error.message);
            });
        });
    </script>
</body>
</html>
